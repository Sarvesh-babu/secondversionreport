	\chapter{Mathematical Modelling}
	\label{chap:mathmodel}
	
	\section{SoC Calculation}
	
	
		
	The SoC of the vehicle is calculated from the following equations:
	

			\begin{equation}
		                             SoC_{min} \leq SoC \leq SoC_{max}\label{eq:socminmax}
		    \end{equation}
	    
where `$SoC_{min}$'  and `$SoC_{max}$' are the minimum and maximum values of SoC and the values are 20 \% and 80 \% respectively.
		    \begin{equation}                         
		               SoC_{y} = SoC_{y-1} + P_{batt}(y) \times \partial y \times \eta c
			\end{equation}
		
		Where `$SoC_{y}$' is the state of charge in present hour and `$SoC_{y-1}$' is the state of charge in the previous hour. `$P_{battery}(y)$' represents the power of the battery in the present hour. `$\partial y$' is the time interval and `$\eta c$' is the charging efficiency which is considered to be 100 \%. 
		
		    \begin{equation}             
		               SoC_{y} = SoC_{y-1} - P_{batt}(y) \times \partial y \times \eta d
			\end{equation}
		
		Where `$SoC_{y}$' is the state of charge in present hour and `$SoC_{y-1}$' is the state of charge in the previous hour. `$P_{battery}(y)$' represents the power of the battery in the present hour. `$\partial y$' is the time interval and `$\eta d$' is the discharging efficiency which is considered to be 100 \%.
		
		    \begin{equation}             
		               P_{batt}(y) = SoC_{y} \times E
		    \end{equation}
	    
	    $P_{battery}(y)$' represents the output power of the battery in the present hour, `$SoC_{y}$' is the state of charge in present hour and $E$ is the energy of the battery. 
		 
\begin{equation}             
	 Initial Power = Generation - Load
\end{equation}

	  SoC limits:  
	 
	   $SoC_{min}$ and $SoC_{max}$ are  the maximum and minimum SoC of the EV respectively.
	   This constraint allows the SoC to vary between predefined minimum and maximum SoC.               
	
	\section{Best Pattern for charging}
	
	
	The charging pattern is determined by comparing the Energy required to the Real Time Price and by  identifying the minimum of it. 
	
	\begin{equation}
		\begin{split}
				T_{n} = \sum_{t=1}^{24} [Ch_{t} \times [1 || 0 || -1 ] ] \ast  Rtp_{t} 
		\end{split}
    \end{equation}	 

where `$T_{n}$' is the cost of `$n^{th}$' iteration, `$i$' ranges from 1 to 24, `$Ch_{t}$' is the energy delivered at time `$t$' and `$Rtp_{t}$' is the real time price at the `$t^{th}$' time interval.

\noindent where `$[ \ 1 \ ||\ 0 \ ||\ -1\ ]$' represents the priority score for charging the vehicles.

	\begin{itemize}
		\item `1' - representing Charging
		\item `0' - representing idle
		\item `-1' - representing discharging
	\end{itemize}


The function `$argmin$'  is used to find the minimum cost from all the `$n$' iterations.	

	\section{Maximum Power required by EV}
	
	
	Maximum Power demand occurs when all the three vehicles loads are high and the time block of maximum demand is identified. 
	\begin{equation}
		\begin{split}
					P_{t(total)} = P_{t(car)} + P_{t(truck)} + P_{t(bus)}
		\end{split}
	\end{equation}	
where `$P_{t(car)}$', `$P_{t(truck)}$', `$P_{t(bus)}$' are the total power of car , truck and bus in $kW$ respectively. `$P_{t(total)}$' is the addition of the total  power of the individual vehicles (i.e.) car , truck and bus.
	\begin{equation}
		\begin{split}
				P_{t(total)} = argmax ~~\prod_{i=1}^{24} \ast P_{t(total)}
		\end{split}
	\end{equation}

`$P_{t(total)}$' is the addition of the total  power of the individual vehicles (i.e.) car , truck and bus. 
The function `$argmax$' is used to find the value of power from the total power. 
	
